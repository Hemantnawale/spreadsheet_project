<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spreadsheet</title>
    <style>
        table {
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            width: 100px;
            height: 30px;
            text-align: center;
        }
        input[type="text"] {
            width: 60%;
        }
    </style>
</head>
<body>
    <h1>Spreadsheet Application</h1>

    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}

    <form method="post">
        {% csrf_token %}
        <table>
            {% for row in grid %}
                <tr>
                    {% for cell in row %}
                        <td>
                            <input type="text" name="cell" value="{{ cell }}">
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>

        <div>
            <label>Range:</label>
            
            <input type="text" name="range" placeholder="e.g., A1:A5">
            
            <br><br>
        </div>
        <div>
            <label>Find:</label>
            <input type="text" name="find" placeholder="Find text">
            
            <br><br>

            <input type="text" name="replace" placeholder="Replace text">
            
            <br><br>
        </div>
        <div>
            <button type="submit" name="operation" value="SUM">SUM</button>
            <button type="submit" name="operation" value="COUNT">COUNT</button>
            <button type="submit" name="operation" value="MIN">MIN</button>
            <button type="submit" name="operation" value="MAX">MAX</button>
            <button type="submit" name="operation" value="AVG">AVG</button>


            <button type="submit" name="operation" value="TRIM">TRIM</button>
            <button type="submit" name="operation" value="UPPER">UPPER</button>
            <button type="submit" name="operation" value="LOWER">LOWER</button>


            <button type="submit" name="operation" value="REMOVE_DUPLICATES">REMOVE DUPLICATES</button>
            <button type="submit" name="operation" value="FIND_REPLACE">FIND & REPLACE</button>
        </div>

        {% if result is not None %}


            <h1>Result: {{ result }}</h1>


        {% endif %}

        
    </form>
</body>
</html>
